# Transport Layer



## 一、运输层提供的服务

​	运输层协议为运行在不同主机上的应用进程之间提供了逻辑通信功能，从字面上看，运输层需要区分同一台主机上的不同进程，以便正确的交付数据，主机依靠 端口号 来区分同一主机上的不同进程。



## 二、几个观点

- 运输层只存在于网络边缘（端系统）的设备中，在网络核心的交换机和路由器中不存在运输层。
- 运输协议能够提供的服务往往受制于底层网络层协议的服务模型。但即使底层网络协议不能在网络层提供相应的服务，运输层协议也能提供某些服务。
- 计算机网络中一个基本的问题：两个实体怎样才能在一种会丢失和损坏数据的媒体上可靠地通信。
- 计算机网络中的另一个基本的问题：控制运输层实体的传输速率以避免网络中的拥塞，或从拥塞中恢复过来。



## 三、UDP



## 四、TCP

### 4.1、多路复用和多路分解（基本服务）

​	TCP套接字是由一个四元组（源IP，源端口号，目的IP，目的端口号）来标识的。因此，当一个TCP报文段从网络到达一台主机时，该主机使用全部的4个值来将报文段定向到相应的套接字。



### 4.2、可靠数据传输（差错控制）

#### 4.2.1、功能正确的协议机制（停等协议）

- 比特错误信道
    - 因特网检验和
    - ACK / NAK
    - 序号

- 丢包信道
    - 定时器

#### 4.2.2、性能优秀的协议机制（流水线机制）

- GBN
- SR



### 4.3、流量控制

- 让发送方维护一个接受窗口。



### 4.4、拥塞控制

- TCP让每一个发送方根据所感知到的网络拥塞程度来限制其能向连接发送流量的速率。
- 网络层未提供显式帮助，TCP采用端到端的拥塞控制方式。
- 两个问题：
    - 如何感知网络的拥塞程度？（如何定义丢包的现象？）
        - 要么出现超时，要么收到来自接收方的3个冗余ACK。
    - 如何限制（改变）发送流量的速率？
        - 丢包了，限制发送速率。
        - 未丢包，增加发送速率。
        - 增加和发送是逐步进行的，其中，ACK和丢包事件充当隐式信号。
- TCP拥塞控制算法：
    - 慢启动
    - 拥塞避免
    - 快速恢复（非必须）



### 4.5、TCP连接及连接管理